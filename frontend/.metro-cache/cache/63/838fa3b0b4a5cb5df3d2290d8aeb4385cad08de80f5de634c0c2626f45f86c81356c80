{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":178},"end":{"line":5,"column":69,"index":247}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"./feedbackService","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":6,"column":0,"index":248},"end":{"line":6,"column":53,"index":301}}],"key":"U7ThhE5E+dAuaWj59PnGSeMTgQY=","exportNames":["*"],"imports":1}},{"name":"./stylePreferencesService","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":7,"column":0,"index":302},"end":{"line":7,"column":64,"index":366}}],"key":"AsC9cBOOt+fhpnx4H6wPycHtdW0=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"default\", {\n    enumerable: true,\n    get: function () {\n      return _default;\n    }\n  });\n  Object.defineProperty(exports, \"getIntelligenceMessage\", {\n    enumerable: true,\n    get: function () {\n      return getIntelligenceMessage;\n    }\n  });\n  Object.defineProperty(exports, \"getFeedbackAcknowledgment\", {\n    enumerable: true,\n    get: function () {\n      return getFeedbackAcknowledgment;\n    }\n  });\n  Object.defineProperty(exports, \"resetIntelligenceState\", {\n    enumerable: true,\n    get: function () {\n      return resetIntelligenceState;\n    }\n  });\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _feedbackService = require(_dependencyMap[1], \"./feedbackService\");\n  var _stylePreferencesService = require(_dependencyMap[2], \"./stylePreferencesService\");\n  // Intelligence Service - Quiet Memory & Learning\n  // Manages soft signals that the app is learning about user's style\n  // DESIGN: Text-only, subtle, no badges/scores/percentages\n\n  const INTELLIGENCE_KEY = '@reveal_intelligence';\n\n  // Store intelligence state\n  const getIntelligenceState = async () => {\n    try {\n      const stored = await AsyncStorage.default.getItem(INTELLIGENCE_KEY);\n      return stored ? JSON.parse(stored) : {\n        messagesShown: [],\n        lastShown: null\n      };\n    } catch (error) {\n      return {\n        messagesShown: [],\n        lastShown: null\n      };\n    }\n  };\n  const saveIntelligenceState = async state => {\n    try {\n      await AsyncStorage.default.setItem(INTELLIGENCE_KEY, JSON.stringify(state));\n    } catch (error) {\n      console.log('Error saving intelligence state:', error);\n    }\n  };\n\n  // Get a gentle, contextual intelligence message\n  // Returns null if no message should be shown (rate limited)\n  const getIntelligenceMessage = async () => {\n    try {\n      const state = await getIntelligenceState();\n      const now = new Date();\n\n      // Rate limit: Don't show messages more than once per session\n      // (24 hours between showing same category of message)\n      if (state.lastShown) {\n        const lastShown = new Date(state.lastShown);\n        const hoursSinceLastShown = (now - lastShown) / (1000 * 60 * 60);\n        if (hoursSinceLastShown < 2) {\n          return null; // Don't show message too frequently\n        }\n      }\n\n      // Get user data to determine what message to show\n      const feedbackStats = await (0, _feedbackService.getFeedbackStats)();\n      const prefs = await (0, _stylePreferencesService.getStylePreferences)();\n      let message = null;\n      let messageId = null;\n\n      // Priority 1: After first feedback\n      if (feedbackStats.total === 1 && !state.messagesShown.includes('first_feedback')) {\n        message = \"Noted. I will remember that.\";\n        messageId = 'first_feedback';\n      }\n      // Priority 2: After several feedbacks\n      else if (feedbackStats.total >= 3 && feedbackStats.total <= 5 && !state.messagesShown.includes('learning')) {\n        message = \"I'm starting to understand your style...\";\n        messageId = 'learning';\n      }\n      // Priority 3: After setting preferences\n      else if (prefs && !state.messagesShown.includes('preferences_set')) {\n        message = \"Your preferences will guide my suggestions.\";\n        messageId = 'preferences_set';\n      }\n      // Priority 4: After many interactions\n      else if (feedbackStats.total >= 8 && !state.messagesShown.includes('knowing_style')) {\n        message = \"Your style is becoming clearer to me.\";\n        messageId = 'knowing_style';\n      }\n\n      // Save that we showed a message\n      if (message && messageId) {\n        await saveIntelligenceState({\n          messagesShown: [...state.messagesShown, messageId],\n          lastShown: now.toISOString()\n        });\n      }\n      return message;\n    } catch (error) {\n      console.log('Error getting intelligence message:', error);\n      return null;\n    }\n  };\n\n  // Get immediate acknowledgment after feedback action\n  // These are shown right away, not rate-limited\n  const getFeedbackAcknowledgment = async type => {\n    if (type === 'like') {\n      return \"Noted. I will keep this in mind.\";\n    } else if (type === 'dislike') {\n      return \"Got it. I will adjust my suggestions.\";\n    }\n    return null;\n  };\n\n  // Reset intelligence state (for testing/debugging)\n  const resetIntelligenceState = async () => {\n    try {\n      await AsyncStorage.default.removeItem(INTELLIGENCE_KEY);\n      return true;\n    } catch (error) {\n      return false;\n    }\n  };\n  var _default = {\n    getIntelligenceMessage,\n    getFeedbackAcknowledgment,\n    resetIntelligenceState\n  };\n});","lineCount":152,"map":[[12,2,110,0,"Object"],[12,8,110,0],[12,9,110,0,"defineProperty"],[12,23,110,0],[12,24,110,0,"exports"],[12,31,110,0],[13,4,110,0,"enumerable"],[13,14,110,0],[14,4,110,0,"get"],[14,7,110,0],[14,18,110,0,"get"],[14,19,110,0],[15,6,110,0],[15,13,110,0,"_default"],[15,21,110,0],[16,4,110,0],[17,2,110,0],[18,2,31,0,"Object"],[18,8,31,0],[18,9,31,0,"defineProperty"],[18,23,31,0],[18,24,31,0,"exports"],[18,31,31,0],[19,4,31,0,"enumerable"],[19,14,31,0],[20,4,31,0,"get"],[20,7,31,0],[20,18,31,0,"get"],[20,19,31,0],[21,6,31,0],[21,13,31,0,"getIntelligenceMessage"],[21,35,31,0],[22,4,31,0],[23,2,31,0],[24,2,91,0,"Object"],[24,8,91,0],[24,9,91,0,"defineProperty"],[24,23,91,0],[24,24,91,0,"exports"],[24,31,91,0],[25,4,91,0,"enumerable"],[25,14,91,0],[26,4,91,0,"get"],[26,7,91,0],[26,18,91,0,"get"],[26,19,91,0],[27,6,91,0],[27,13,91,0,"getFeedbackAcknowledgment"],[27,38,91,0],[28,4,91,0],[29,2,91,0],[30,2,101,0,"Object"],[30,8,101,0],[30,9,101,0,"defineProperty"],[30,23,101,0],[30,24,101,0,"exports"],[30,31,101,0],[31,4,101,0,"enumerable"],[31,14,101,0],[32,4,101,0,"get"],[32,7,101,0],[32,18,101,0,"get"],[32,19,101,0],[33,6,101,0],[33,13,101,0,"resetIntelligenceState"],[33,35,101,0],[34,4,101,0],[35,2,101,0],[36,2,5,0],[36,6,5,0,"_reactNativeAsyncStorageAsyncStorage"],[36,42,5,0],[36,45,5,0,"require"],[36,52,5,0],[36,53,5,0,"_dependencyMap"],[36,67,5,0],[37,2,5,0],[37,6,5,0,"AsyncStorage"],[37,18,5,0],[37,21,5,0,"_interopDefault"],[37,36,5,0],[37,37,5,0,"_reactNativeAsyncStorageAsyncStorage"],[37,73,5,0],[38,2,6,0],[38,6,6,0,"_feedbackService"],[38,22,6,0],[38,25,6,0,"require"],[38,32,6,0],[38,33,6,0,"_dependencyMap"],[38,47,6,0],[39,2,7,0],[39,6,7,0,"_stylePreferencesService"],[39,30,7,0],[39,33,7,0,"require"],[39,40,7,0],[39,41,7,0,"_dependencyMap"],[39,55,7,0],[40,2,1,0],[41,2,2,0],[42,2,3,0],[44,2,9,0],[44,8,9,6,"INTELLIGENCE_KEY"],[44,24,9,22],[44,27,9,25],[44,49,9,47],[46,2,11,0],[47,2,12,0],[47,8,12,6,"getIntelligenceState"],[47,28,12,26],[47,31,12,29],[47,37,12,29,"getIntelligenceState"],[47,38,12,29],[47,43,12,41],[48,4,13,2],[48,8,13,6],[49,6,14,4],[49,12,14,10,"stored"],[49,18,14,16],[49,21,14,19],[49,27,14,25,"AsyncStorage"],[49,39,14,37],[49,40,14,37,"default"],[49,47,14,37],[49,48,14,38,"getItem"],[49,55,14,45],[49,56,14,46,"INTELLIGENCE_KEY"],[49,72,14,62],[49,73,14,63],[50,6,15,4],[50,13,15,11,"stored"],[50,19,15,17],[50,22,15,20,"JSON"],[50,26,15,24],[50,27,15,25,"parse"],[50,32,15,30],[50,33,15,31,"stored"],[50,39,15,37],[50,40,15,38],[50,43,15,41],[51,8,15,43,"messagesShown"],[51,21,15,56],[51,23,15,58],[51,25,15,60],[52,8,15,62,"lastShown"],[52,17,15,71],[52,19,15,73],[53,6,15,78],[53,7,15,79],[54,4,16,2],[54,5,16,3],[54,6,16,4],[54,13,16,11,"error"],[54,18,16,16],[54,20,16,18],[55,6,17,4],[55,13,17,11],[56,8,17,13,"messagesShown"],[56,21,17,26],[56,23,17,28],[56,25,17,30],[57,8,17,32,"lastShown"],[57,17,17,41],[57,19,17,43],[58,6,17,48],[58,7,17,49],[59,4,18,2],[60,2,19,0],[60,3,19,1],[61,2,21,0],[61,8,21,6,"saveIntelligenceState"],[61,29,21,27],[61,32,21,30],[61,38,21,37,"state"],[61,43,21,42],[61,47,21,47],[62,4,22,2],[62,8,22,6],[63,6,23,4],[63,12,23,10,"AsyncStorage"],[63,24,23,22],[63,25,23,22,"default"],[63,32,23,22],[63,33,23,23,"setItem"],[63,40,23,30],[63,41,23,31,"INTELLIGENCE_KEY"],[63,57,23,47],[63,59,23,49,"JSON"],[63,63,23,53],[63,64,23,54,"stringify"],[63,73,23,63],[63,74,23,64,"state"],[63,79,23,69],[63,80,23,70],[63,81,23,71],[64,4,24,2],[64,5,24,3],[64,6,24,4],[64,13,24,11,"error"],[64,18,24,16],[64,20,24,18],[65,6,25,4,"console"],[65,13,25,11],[65,14,25,12,"log"],[65,17,25,15],[65,18,25,16],[65,52,25,50],[65,54,25,52,"error"],[65,59,25,57],[65,60,25,58],[66,4,26,2],[67,2,27,0],[67,3,27,1],[69,2,29,0],[70,2,30,0],[71,2,31,7],[71,8,31,13,"getIntelligenceMessage"],[71,30,31,35],[71,33,31,38],[71,39,31,38,"getIntelligenceMessage"],[71,40,31,38],[71,45,31,50],[72,4,32,2],[72,8,32,6],[73,6,33,4],[73,12,33,10,"state"],[73,17,33,15],[73,20,33,18],[73,26,33,24,"getIntelligenceState"],[73,46,33,44],[73,47,33,45],[73,48,33,46],[74,6,34,4],[74,12,34,10,"now"],[74,15,34,13],[74,18,34,16],[74,22,34,20,"Date"],[74,26,34,24],[74,27,34,25],[74,28,34,26],[76,6,36,4],[77,6,37,4],[78,6,38,4],[78,10,38,8,"state"],[78,15,38,13],[78,16,38,14,"lastShown"],[78,25,38,23],[78,27,38,25],[79,8,39,6],[79,14,39,12,"lastShown"],[79,23,39,21],[79,26,39,24],[79,30,39,28,"Date"],[79,34,39,32],[79,35,39,33,"state"],[79,40,39,38],[79,41,39,39,"lastShown"],[79,50,39,48],[79,51,39,49],[80,8,40,6],[80,14,40,12,"hoursSinceLastShown"],[80,33,40,31],[80,36,40,34],[80,37,40,35,"now"],[80,40,40,38],[80,43,40,41,"lastShown"],[80,52,40,50],[80,57,40,55],[80,61,40,59],[80,64,40,62],[80,66,40,64],[80,69,40,67],[80,71,40,69],[80,72,40,70],[81,8,41,6],[81,12,41,10,"hoursSinceLastShown"],[81,31,41,29],[81,34,41,32],[81,35,41,33],[81,37,41,35],[82,10,42,8],[82,17,42,15],[82,21,42,19],[82,22,42,20],[82,23,42,21],[83,8,43,6],[84,6,44,4],[86,6,46,4],[87,6,47,4],[87,12,47,10,"feedbackStats"],[87,25,47,23],[87,28,47,26],[87,34,47,32],[87,38,47,32,"getFeedbackStats"],[87,54,47,48],[87,55,47,48,"getFeedbackStats"],[87,71,47,48],[87,73,47,49],[87,74,47,50],[88,6,48,4],[88,12,48,10,"prefs"],[88,17,48,15],[88,20,48,18],[88,26,48,24],[88,30,48,24,"getStylePreferences"],[88,54,48,43],[88,55,48,43,"getStylePreferences"],[88,74,48,43],[88,76,48,44],[88,77,48,45],[89,6,50,4],[89,10,50,8,"message"],[89,17,50,15],[89,20,50,18],[89,24,50,22],[90,6,51,4],[90,10,51,8,"messageId"],[90,19,51,17],[90,22,51,20],[90,26,51,24],[92,6,53,4],[93,6,54,4],[93,10,54,8,"feedbackStats"],[93,23,54,21],[93,24,54,22,"total"],[93,29,54,27],[93,34,54,32],[93,35,54,33],[93,39,54,37],[93,40,54,38,"state"],[93,45,54,43],[93,46,54,44,"messagesShown"],[93,59,54,57],[93,60,54,58,"includes"],[93,68,54,66],[93,69,54,67],[93,85,54,83],[93,86,54,84],[93,88,54,86],[94,8,55,6,"message"],[94,15,55,13],[94,18,55,16],[94,48,55,46],[95,8,56,6,"messageId"],[95,17,56,15],[95,20,56,18],[95,36,56,34],[96,6,57,4],[97,6,58,4],[98,6,58,4],[98,11,59,9],[98,15,59,13,"feedbackStats"],[98,28,59,26],[98,29,59,27,"total"],[98,34,59,32],[98,38,59,36],[98,39,59,37],[98,43,59,41,"feedbackStats"],[98,56,59,54],[98,57,59,55,"total"],[98,62,59,60],[98,66,59,64],[98,67,59,65],[98,71,59,69],[98,72,59,70,"state"],[98,77,59,75],[98,78,59,76,"messagesShown"],[98,91,59,89],[98,92,59,90,"includes"],[98,100,59,98],[98,101,59,99],[98,111,59,109],[98,112,59,110],[98,114,59,112],[99,8,60,6,"message"],[99,15,60,13],[99,18,60,16],[99,60,60,58],[100,8,61,6,"messageId"],[100,17,61,15],[100,20,61,18],[100,30,61,28],[101,6,62,4],[102,6,63,4],[103,6,63,4],[103,11,64,9],[103,15,64,13,"prefs"],[103,20,64,18],[103,24,64,22],[103,25,64,23,"state"],[103,30,64,28],[103,31,64,29,"messagesShown"],[103,44,64,42],[103,45,64,43,"includes"],[103,53,64,51],[103,54,64,52],[103,71,64,69],[103,72,64,70],[103,74,64,72],[104,8,65,6,"message"],[104,15,65,13],[104,18,65,16],[104,63,65,61],[105,8,66,6,"messageId"],[105,17,66,15],[105,20,66,18],[105,37,66,35],[106,6,67,4],[107,6,68,4],[108,6,68,4],[108,11,69,9],[108,15,69,13,"feedbackStats"],[108,28,69,26],[108,29,69,27,"total"],[108,34,69,32],[108,38,69,36],[108,39,69,37],[108,43,69,41],[108,44,69,42,"state"],[108,49,69,47],[108,50,69,48,"messagesShown"],[108,63,69,61],[108,64,69,62,"includes"],[108,72,69,70],[108,73,69,71],[108,88,69,86],[108,89,69,87],[108,91,69,89],[109,8,70,6,"message"],[109,15,70,13],[109,18,70,16],[109,57,70,55],[110,8,71,6,"messageId"],[110,17,71,15],[110,20,71,18],[110,35,71,33],[111,6,72,4],[113,6,74,4],[114,6,75,4],[114,10,75,8,"message"],[114,17,75,15],[114,21,75,19,"messageId"],[114,30,75,28],[114,32,75,30],[115,8,76,6],[115,14,76,12,"saveIntelligenceState"],[115,35,76,33],[115,36,76,34],[116,10,77,8,"messagesShown"],[116,23,77,21],[116,25,77,23],[116,26,77,24],[116,29,77,27,"state"],[116,34,77,32],[116,35,77,33,"messagesShown"],[116,48,77,46],[116,50,77,48,"messageId"],[116,59,77,57],[116,60,77,58],[117,10,78,8,"lastShown"],[117,19,78,17],[117,21,78,19,"now"],[117,24,78,22],[117,25,78,23,"toISOString"],[117,36,78,34],[117,37,78,35],[118,8,79,6],[118,9,79,7],[118,10,79,8],[119,6,80,4],[120,6,82,4],[120,13,82,11,"message"],[120,20,82,18],[121,4,83,2],[121,5,83,3],[121,6,83,4],[121,13,83,11,"error"],[121,18,83,16],[121,20,83,18],[122,6,84,4,"console"],[122,13,84,11],[122,14,84,12,"log"],[122,17,84,15],[122,18,84,16],[122,55,84,53],[122,57,84,55,"error"],[122,62,84,60],[122,63,84,61],[123,6,85,4],[123,13,85,11],[123,17,85,15],[124,4,86,2],[125,2,87,0],[125,3,87,1],[127,2,89,0],[128,2,90,0],[129,2,91,7],[129,8,91,13,"getFeedbackAcknowledgment"],[129,33,91,38],[129,36,91,41],[129,42,91,48,"type"],[129,46,91,52],[129,50,91,57],[130,4,92,2],[130,8,92,6,"type"],[130,12,92,10],[130,17,92,15],[130,23,92,21],[130,25,92,23],[131,6,93,4],[131,13,93,11],[131,47,93,45],[132,4,94,2],[132,5,94,3],[132,11,94,9],[132,15,94,13,"type"],[132,19,94,17],[132,24,94,22],[132,33,94,31],[132,35,94,33],[133,6,95,4],[133,13,95,11],[133,52,95,50],[134,4,96,2],[135,4,97,2],[135,11,97,9],[135,15,97,13],[136,2,98,0],[136,3,98,1],[138,2,100,0],[139,2,101,7],[139,8,101,13,"resetIntelligenceState"],[139,30,101,35],[139,33,101,38],[139,39,101,38,"resetIntelligenceState"],[139,40,101,38],[139,45,101,50],[140,4,102,2],[140,8,102,6],[141,6,103,4],[141,12,103,10,"AsyncStorage"],[141,24,103,22],[141,25,103,22,"default"],[141,32,103,22],[141,33,103,23,"removeItem"],[141,43,103,33],[141,44,103,34,"INTELLIGENCE_KEY"],[141,60,103,50],[141,61,103,51],[142,6,104,4],[142,13,104,11],[142,17,104,15],[143,4,105,2],[143,5,105,3],[143,6,105,4],[143,13,105,11,"error"],[143,18,105,16],[143,20,105,18],[144,6,106,4],[144,13,106,11],[144,18,106,16],[145,4,107,2],[146,2,108,0],[146,3,108,1],[147,2,110,0],[147,6,110,0,"_default"],[147,14,110,0],[147,17,110,15],[148,4,111,2,"getIntelligenceMessage"],[148,26,111,24],[149,4,112,2,"getFeedbackAcknowledgment"],[149,29,112,27],[150,4,113,2,"resetIntelligenceState"],[151,2,114,0],[151,3,114,1],[152,0,114,2],[152,3]],"functionMap":{"names":["<global>","getIntelligenceState","saveIntelligenceState","getIntelligenceMessage","getFeedbackAcknowledgment","resetIntelligenceState"],"mappings":"AAA;6BCW;CDO;8BEE;CFM;sCGI;CHwD;yCII;CJO;sCKG;CLO"},"hasCjsExports":false},"type":"js/module"}]}